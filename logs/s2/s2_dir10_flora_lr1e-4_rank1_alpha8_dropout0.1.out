GPU details saved to $output_file
__CUDA Device Total Memory [GB]: 42.297786368
args.dataset: sst2
args.num_labels: 2
==================================================
Personalized Federated Learning: True
Uniform Weight: False
Normalized Rank: False
Normalized Alpha: False
lora_rank: 1
lora_alpha: 8
lora_dropout: 0.1
lora_query: True
lora_key: True
lora_value: True
lora_projection: True
lora_mlp: True
lora_head: True
aa_bottleneck_reduction: 1
aa_text: False
aa_vision: False
ca_bottleneck_reduction: 4
ca_text: False
ca_vision: False
Seed: 42
Algorithm: flora
Local batch size: 128
Local epochs: 1
Local learing rate: 0.0001
Local learing rate decay: False
Total number of clients: 10
Clients join in each round: 1.0
Clients randomly join: False
Client drop rate: 0.0
Client select regarding time: False
Running times: 1
Dataset: sst2
Number of classes: 10
Backbone: distilbert
Using device: cuda
Using DP: False
Auto break: False
Global rounds: 100
Cuda device id: 3
DLG attack: False
Total number of new clients: 0
Fine tuning epoches on new clients: 0
==================================================

============= Running time: 0th =============
Creating server and clients ...
Loaded train data from ../dataset/sst2/train/0.npz
Data length: 1
Loaded test data from ../dataset/sst2/test/0.npz
Data length: 1
self.lora_params: {'rank': 1, 'alpha': 8, 'dropout': 0.1, 'lora_query': True, 'lora_key': True, 'lora_value': True, 'lora_projection': True, 'lora_mlp': True, 'lora_head': True}
Loaded train data from ../dataset/sst2/train/1.npz
Data length: 1
Loaded test data from ../dataset/sst2/test/1.npz
Data length: 1
self.lora_params: {'rank': 1, 'alpha': 8, 'dropout': 0.1, 'lora_query': True, 'lora_key': True, 'lora_value': True, 'lora_projection': True, 'lora_mlp': True, 'lora_head': True}
Loaded train data from ../dataset/sst2/train/2.npz
Data length: 1
Loaded test data from ../dataset/sst2/test/2.npz
Data length: 1
self.lora_params: {'rank': 1, 'alpha': 8, 'dropout': 0.1, 'lora_query': True, 'lora_key': True, 'lora_value': True, 'lora_projection': True, 'lora_mlp': True, 'lora_head': True}
Loaded train data from ../dataset/sst2/train/3.npz
Data length: 1
Loaded test data from ../dataset/sst2/test/3.npz
Data length: 1
self.lora_params: {'rank': 1, 'alpha': 8, 'dropout': 0.1, 'lora_query': True, 'lora_key': True, 'lora_value': True, 'lora_projection': True, 'lora_mlp': True, 'lora_head': True}
Loaded train data from ../dataset/sst2/train/4.npz
Data length: 1
Loaded test data from ../dataset/sst2/test/4.npz
Data length: 1
self.lora_params: {'rank': 1, 'alpha': 8, 'dropout': 0.1, 'lora_query': True, 'lora_key': True, 'lora_value': True, 'lora_projection': True, 'lora_mlp': True, 'lora_head': True}
Loaded train data from ../dataset/sst2/train/5.npz
Data length: 1
Loaded test data from ../dataset/sst2/test/5.npz
Data length: 1
self.lora_params: {'rank': 1, 'alpha': 8, 'dropout': 0.1, 'lora_query': True, 'lora_key': True, 'lora_value': True, 'lora_projection': True, 'lora_mlp': True, 'lora_head': True}
Loaded train data from ../dataset/sst2/train/6.npz
Data length: 1
Loaded test data from ../dataset/sst2/test/6.npz
Data length: 1
self.lora_params: {'rank': 1, 'alpha': 8, 'dropout': 0.1, 'lora_query': True, 'lora_key': True, 'lora_value': True, 'lora_projection': True, 'lora_mlp': True, 'lora_head': True}
Loaded train data from ../dataset/sst2/train/7.npz
Data length: 1
Loaded test data from ../dataset/sst2/test/7.npz
Data length: 1
self.lora_params: {'rank': 1, 'alpha': 8, 'dropout': 0.1, 'lora_query': True, 'lora_key': True, 'lora_value': True, 'lora_projection': True, 'lora_mlp': True, 'lora_head': True}
Loaded train data from ../dataset/sst2/train/8.npz
Data length: 1
Loaded test data from ../dataset/sst2/test/8.npz
Data length: 1
self.lora_params: {'rank': 1, 'alpha': 8, 'dropout': 0.1, 'lora_query': True, 'lora_key': True, 'lora_value': True, 'lora_projection': True, 'lora_mlp': True, 'lora_head': True}
Loaded train data from ../dataset/sst2/train/9.npz
Data length: 1
Loaded test data from ../dataset/sst2/test/9.npz
Data length: 1
self.lora_params: {'rank': 1, 'alpha': 8, 'dropout': 0.1, 'lora_query': True, 'lora_key': True, 'lora_value': True, 'lora_projection': True, 'lora_mlp': True, 'lora_head': True}

Join ratio / total clients: 1.0 / 10
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate global model
Loaded test data from ../dataset/sst2/test/0.npz
Data length: 1
metric.compute(): {'accuracy': 0.545774647887324}
ct, ns, auc: 0.545774647887324, 0, 0
Loaded test data from ../dataset/sst2/test/1.npz
Data length: 1
metric.compute(): {'accuracy': 0.45231455660903513}
ct, ns, auc: 0.45231455660903513, 0, 0
Loaded test data from ../dataset/sst2/test/2.npz
Data length: 1
metric.compute(): {'accuracy': 0.5250379362670713}
ct, ns, auc: 0.5250379362670713, 0, 0
Loaded test data from ../dataset/sst2/test/3.npz
Data length: 1
metric.compute(): {'accuracy': 0.548932384341637}
ct, ns, auc: 0.548932384341637, 0, 0
Loaded test data from ../dataset/sst2/test/4.npz
Data length: 1
metric.compute(): {'accuracy': 0.579415501905972}
ct, ns, auc: 0.579415501905972, 0, 0
Loaded test data from ../dataset/sst2/test/5.npz
Data length: 1
metric.compute(): {'accuracy': 0.45546558704453444}
ct, ns, auc: 0.45546558704453444, 0, 0
Loaded test data from ../dataset/sst2/test/6.npz
Data length: 1
metric.compute(): {'accuracy': 0.44282238442822386}
ct, ns, auc: 0.44282238442822386, 0, 0
Loaded test data from ../dataset/sst2/test/7.npz
Data length: 1
metric.compute(): {'accuracy': 0.5560806553245117}
ct, ns, auc: 0.5560806553245117, 0, 0
Loaded test data from ../dataset/sst2/test/8.npz
Data length: 1
metric.compute(): {'accuracy': 0.5644547759932376}
ct, ns, auc: 0.5644547759932376, 0, 0
Loaded test data from ../dataset/sst2/test/9.npz
Data length: 1
metric.compute(): {'accuracy': 0.4602026049204052}
ct, ns, auc: 0.4602026049204052, 0, 0
ids: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
stats[1]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
stats[2]: [0.545774647887324, 0.45231455660903513, 0.5250379362670713, 0.548932384341637, 0.579415501905972, 0.45546558704453444, 0.44282238442822386, 0.5560806553245117, 0.5644547759932376, 0.4602026049204052]
stats[3]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Averaged Test Accuracy: 0.5131
Averaged Test AUC: 0.0000
Std Test Accuracy: 0.0539
Std Test AUC: 0.0000
Loaded train data from ../dataset/sst2/train/8.npz
Data length: 1
Time elapsed 0.16 min
Memory used: 7.83 GB
Loaded train data from ../dataset/sst2/train/1.npz
Data length: 1
Time elapsed 0.06 min
Memory used: 7.84 GB
Loaded train data from ../dataset/sst2/train/5.npz
Data length: 1
Time elapsed 0.05 min
Memory used: 7.84 GB
Loaded train data from ../dataset/sst2/train/0.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.84 GB
Loaded train data from ../dataset/sst2/train/7.npz
Data length: 1
Time elapsed 0.11 min
Memory used: 7.84 GB
Loaded train data from ../dataset/sst2/train/2.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.84 GB
Loaded train data from ../dataset/sst2/train/9.npz
Data length: 1
Time elapsed 0.02 min
Memory used: 7.87 GB
Loaded train data from ../dataset/sst2/train/4.npz
Data length: 1
Time elapsed 0.03 min
Memory used: 7.87 GB
Loaded train data from ../dataset/sst2/train/3.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.87 GB
Loaded train data from ../dataset/sst2/train/6.npz
Data length: 1
Time elapsed 0.03 min
Memory used: 7.87 GB
------------------------- time cost ------------------------- 66.1941864490509

-------------Round number: 1-------------

Evaluate global model
Loaded test data from ../dataset/sst2/test/0.npz
Data length: 1
metric.compute(): {'accuracy': 0.801056338028169}
ct, ns, auc: 0.801056338028169, 0, 0
Loaded test data from ../dataset/sst2/test/1.npz
Data length: 1
metric.compute(): {'accuracy': 0.8165086447295036}
ct, ns, auc: 0.8165086447295036, 0, 0
Loaded test data from ../dataset/sst2/test/2.npz
Data length: 1
metric.compute(): {'accuracy': 0.6987860394537178}
ct, ns, auc: 0.6987860394537178, 0, 0
Loaded test data from ../dataset/sst2/test/3.npz
Data length: 1
metric.compute(): {'accuracy': 0.5791814946619217}
ct, ns, auc: 0.5791814946619217, 0, 0
Loaded test data from ../dataset/sst2/test/4.npz
Data length: 1
metric.compute(): {'accuracy': 0.6836086404066074}
ct, ns, auc: 0.6836086404066074, 0, 0
Loaded test data from ../dataset/sst2/test/5.npz
Data length: 1
metric.compute(): {'accuracy': 0.8441295546558705}
ct, ns, auc: 0.8441295546558705, 0, 0
Loaded test data from ../dataset/sst2/test/6.npz
Data length: 1
metric.compute(): {'accuracy': 0.4440389294403893}
ct, ns, auc: 0.4440389294403893, 0, 0
Loaded test data from ../dataset/sst2/test/7.npz
Data length: 1
metric.compute(): {'accuracy': 0.41776937618147447}
ct, ns, auc: 0.41776937618147447, 0, 0
Loaded test data from ../dataset/sst2/test/8.npz
Data length: 1
metric.compute(): {'accuracy': 0.8594674556213018}
ct, ns, auc: 0.8594674556213018, 0, 0
Loaded test data from ../dataset/sst2/test/9.npz
Data length: 1
metric.compute(): {'accuracy': 0.4717800289435601}
ct, ns, auc: 0.4717800289435601, 0, 0
ids: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
stats[1]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
stats[2]: [0.801056338028169, 0.8165086447295036, 0.6987860394537178, 0.5791814946619217, 0.6836086404066074, 0.8441295546558705, 0.4440389294403893, 0.41776937618147447, 0.8594674556213018, 0.4717800289435601]
stats[3]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Averaged Test Accuracy: 0.6616
Averaged Test AUC: 0.0000
Std Test Accuracy: 0.1724
Std Test AUC: 0.0000
Loaded train data from ../dataset/sst2/train/4.npz
Data length: 1
Time elapsed 0.03 min
Memory used: 7.87 GB
Loaded train data from ../dataset/sst2/train/2.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.87 GB
Loaded train data from ../dataset/sst2/train/7.npz
Data length: 1
Time elapsed 0.11 min
Memory used: 7.87 GB
Loaded train data from ../dataset/sst2/train/5.npz
Data length: 1
Time elapsed 0.05 min
Memory used: 7.87 GB
Loaded train data from ../dataset/sst2/train/3.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.87 GB
Loaded train data from ../dataset/sst2/train/6.npz
Data length: 1
Time elapsed 0.03 min
Memory used: 7.87 GB
Loaded train data from ../dataset/sst2/train/0.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.87 GB
Loaded train data from ../dataset/sst2/train/8.npz
Data length: 1
Time elapsed 0.16 min
Memory used: 7.87 GB
Loaded train data from ../dataset/sst2/train/1.npz
Data length: 1
Time elapsed 0.06 min
Memory used: 7.87 GB
Loaded train data from ../dataset/sst2/train/9.npz
Data length: 1
Time elapsed 0.02 min
Memory used: 7.88 GB
------------------------- time cost ------------------------- 65.47510528564453

-------------Round number: 2-------------

Evaluate global model
Loaded test data from ../dataset/sst2/test/0.npz
Data length: 1
metric.compute(): {'accuracy': 0.8899647887323944}
ct, ns, auc: 0.8899647887323944, 0, 0
Loaded test data from ../dataset/sst2/test/1.npz
Data length: 1
metric.compute(): {'accuracy': 0.8862242052426101}
ct, ns, auc: 0.8862242052426101, 0, 0
Loaded test data from ../dataset/sst2/test/2.npz
Data length: 1
metric.compute(): {'accuracy': 0.877845220030349}
ct, ns, auc: 0.877845220030349, 0, 0
Loaded test data from ../dataset/sst2/test/3.npz
Data length: 1
metric.compute(): {'accuracy': 0.847864768683274}
ct, ns, auc: 0.847864768683274, 0, 0
Loaded test data from ../dataset/sst2/test/4.npz
Data length: 1
metric.compute(): {'accuracy': 0.841168996188056}
ct, ns, auc: 0.841168996188056, 0, 0
Loaded test data from ../dataset/sst2/test/5.npz
Data length: 1
metric.compute(): {'accuracy': 0.8852901484480432}
ct, ns, auc: 0.8852901484480432, 0, 0
Loaded test data from ../dataset/sst2/test/6.npz
Data length: 1
metric.compute(): {'accuracy': 0.7725060827250608}
ct, ns, auc: 0.7725060827250608, 0, 0
Loaded test data from ../dataset/sst2/test/7.npz
Data length: 1
metric.compute(): {'accuracy': 0.8761814744801513}
ct, ns, auc: 0.8761814744801513, 0, 0
Loaded test data from ../dataset/sst2/test/8.npz
Data length: 1
metric.compute(): {'accuracy': 0.88229078613694}
ct, ns, auc: 0.88229078613694, 0, 0
Loaded test data from ../dataset/sst2/test/9.npz
Data length: 1
metric.compute(): {'accuracy': 0.6931982633863966}
ct, ns, auc: 0.6931982633863966, 0, 0
ids: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
stats[1]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
stats[2]: [0.8899647887323944, 0.8862242052426101, 0.877845220030349, 0.847864768683274, 0.841168996188056, 0.8852901484480432, 0.7725060827250608, 0.8761814744801513, 0.88229078613694, 0.6931982633863966]
stats[3]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Averaged Test Accuracy: 0.8453
Averaged Test AUC: 0.0000
Std Test Accuracy: 0.0642
Std Test AUC: 0.0000
Loaded train data from ../dataset/sst2/train/8.npz
Data length: 1
Time elapsed 0.16 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/4.npz
Data length: 1
Time elapsed 0.03 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/2.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/6.npz
Data length: 1
Time elapsed 0.03 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/5.npz
Data length: 1
Time elapsed 0.05 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/9.npz
Data length: 1
Time elapsed 0.02 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/1.npz
Data length: 1
Time elapsed 0.06 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/3.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/0.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/7.npz
Data length: 1
Time elapsed 0.11 min
Memory used: 7.88 GB
------------------------- time cost ------------------------- 72.17059421539307

-------------Round number: 3-------------

Evaluate global model
Loaded test data from ../dataset/sst2/test/0.npz
Data length: 1
metric.compute(): {'accuracy': 0.9058098591549296}
ct, ns, auc: 0.9058098591549296, 0, 0
Loaded test data from ../dataset/sst2/test/1.npz
Data length: 1
metric.compute(): {'accuracy': 0.8918014500836586}
ct, ns, auc: 0.8918014500836586, 0, 0
Loaded test data from ../dataset/sst2/test/2.npz
Data length: 1
metric.compute(): {'accuracy': 0.8960546282245827}
ct, ns, auc: 0.8960546282245827, 0, 0
Loaded test data from ../dataset/sst2/test/3.npz
Data length: 1
metric.compute(): {'accuracy': 0.8718861209964412}
ct, ns, auc: 0.8718861209964412, 0, 0
Loaded test data from ../dataset/sst2/test/4.npz
Data length: 1
metric.compute(): {'accuracy': 0.8487928843710292}
ct, ns, auc: 0.8487928843710292, 0, 0
Loaded test data from ../dataset/sst2/test/5.npz
Data length: 1
metric.compute(): {'accuracy': 0.9068825910931174}
ct, ns, auc: 0.9068825910931174, 0, 0
Loaded test data from ../dataset/sst2/test/6.npz
Data length: 1
metric.compute(): {'accuracy': 0.8236009732360098}
ct, ns, auc: 0.8236009732360098, 0, 0
Loaded test data from ../dataset/sst2/test/7.npz
Data length: 1
metric.compute(): {'accuracy': 0.8938248267170762}
ct, ns, auc: 0.8938248267170762, 0, 0
Loaded test data from ../dataset/sst2/test/8.npz
Data length: 1
metric.compute(): {'accuracy': 0.893279797125951}
ct, ns, auc: 0.893279797125951, 0, 0
Loaded test data from ../dataset/sst2/test/9.npz
Data length: 1
metric.compute(): {'accuracy': 0.8465991316931982}
ct, ns, auc: 0.8465991316931982, 0, 0
ids: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
stats[1]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
stats[2]: [0.9058098591549296, 0.8918014500836586, 0.8960546282245827, 0.8718861209964412, 0.8487928843710292, 0.9068825910931174, 0.8236009732360098, 0.8938248267170762, 0.893279797125951, 0.8465991316931982]
stats[3]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Averaged Test Accuracy: 0.8779
Averaged Test AUC: 0.0000
Std Test Accuracy: 0.0288
Std Test AUC: 0.0000
Loaded train data from ../dataset/sst2/train/8.npz
Data length: 1
Time elapsed 0.16 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/1.npz
Data length: 1
Time elapsed 0.07 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/5.npz
Data length: 1
Time elapsed 0.05 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/0.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/9.npz
Data length: 1
Time elapsed 0.02 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/6.npz
Data length: 1
Time elapsed 0.03 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/3.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/7.npz
Data length: 1
Time elapsed 0.11 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/4.npz
Data length: 1
Time elapsed 0.03 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/2.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.88 GB
------------------------- time cost ------------------------- 65.63746690750122

-------------Round number: 4-------------

Evaluate global model
Loaded test data from ../dataset/sst2/test/0.npz
Data length: 1
metric.compute(): {'accuracy': 0.9128521126760564}
ct, ns, auc: 0.9128521126760564, 0, 0
Loaded test data from ../dataset/sst2/test/1.npz
Data length: 1
metric.compute(): {'accuracy': 0.8906860011154489}
ct, ns, auc: 0.8906860011154489, 0, 0
Loaded test data from ../dataset/sst2/test/2.npz
Data length: 1
metric.compute(): {'accuracy': 0.8983308042488619}
ct, ns, auc: 0.8983308042488619, 0, 0
Loaded test data from ../dataset/sst2/test/3.npz
Data length: 1
metric.compute(): {'accuracy': 0.8861209964412812}
ct, ns, auc: 0.8861209964412812, 0, 0
Loaded test data from ../dataset/sst2/test/4.npz
Data length: 1
metric.compute(): {'accuracy': 0.8526048284625158}
ct, ns, auc: 0.8526048284625158, 0, 0
Loaded test data from ../dataset/sst2/test/5.npz
Data length: 1
metric.compute(): {'accuracy': 0.9109311740890689}
ct, ns, auc: 0.9109311740890689, 0, 0
Loaded test data from ../dataset/sst2/test/6.npz
Data length: 1
metric.compute(): {'accuracy': 0.8673965936739659}
ct, ns, auc: 0.8673965936739659, 0, 0
Loaded test data from ../dataset/sst2/test/7.npz
Data length: 1
metric.compute(): {'accuracy': 0.9010712035286704}
ct, ns, auc: 0.9010712035286704, 0, 0
Loaded test data from ../dataset/sst2/test/8.npz
Data length: 1
metric.compute(): {'accuracy': 0.893279797125951}
ct, ns, auc: 0.893279797125951, 0, 0
Loaded test data from ../dataset/sst2/test/9.npz
Data length: 1
metric.compute(): {'accuracy': 0.8842257597684515}
ct, ns, auc: 0.8842257597684515, 0, 0
ids: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
stats[1]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
stats[2]: [0.9128521126760564, 0.8906860011154489, 0.8983308042488619, 0.8861209964412812, 0.8526048284625158, 0.9109311740890689, 0.8673965936739659, 0.9010712035286704, 0.893279797125951, 0.8842257597684515]
stats[3]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Averaged Test Accuracy: 0.8897
Averaged Test AUC: 0.0000
Std Test Accuracy: 0.0186
Std Test AUC: 0.0000
Loaded train data from ../dataset/sst2/train/1.npz
Data length: 1
Time elapsed 0.06 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/0.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/9.npz
Data length: 1
Time elapsed 0.02 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/4.npz
Data length: 1
Time elapsed 0.03 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/7.npz
Data length: 1
Time elapsed 0.11 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/3.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/8.npz
Data length: 1
Time elapsed 0.16 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/6.npz
Data length: 1
Time elapsed 0.03 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/2.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/5.npz
Data length: 1
Time elapsed 0.05 min
Memory used: 7.88 GB
------------------------- time cost ------------------------- 74.59534025192261

-------------Round number: 5-------------

Evaluate global model
Loaded test data from ../dataset/sst2/test/0.npz
Data length: 1
metric.compute(): {'accuracy': 0.9137323943661971}
ct, ns, auc: 0.9137323943661971, 0, 0
Loaded test data from ../dataset/sst2/test/1.npz
Data length: 1
metric.compute(): {'accuracy': 0.9029559397657557}
ct, ns, auc: 0.9029559397657557, 0, 0
Loaded test data from ../dataset/sst2/test/2.npz
Data length: 1
metric.compute(): {'accuracy': 0.9021244309559939}
ct, ns, auc: 0.9021244309559939, 0, 0
Loaded test data from ../dataset/sst2/test/3.npz
Data length: 1
metric.compute(): {'accuracy': 0.8905693950177936}
ct, ns, auc: 0.8905693950177936, 0, 0
Loaded test data from ../dataset/sst2/test/4.npz
Data length: 1
metric.compute(): {'accuracy': 0.8767471410419314}
ct, ns, auc: 0.8767471410419314, 0, 0
Loaded test data from ../dataset/sst2/test/5.npz
Data length: 1
metric.compute(): {'accuracy': 0.9136302294197031}
ct, ns, auc: 0.9136302294197031, 0, 0
Loaded test data from ../dataset/sst2/test/6.npz
Data length: 1
metric.compute(): {'accuracy': 0.902676399026764}
ct, ns, auc: 0.902676399026764, 0, 0
Loaded test data from ../dataset/sst2/test/7.npz
Data length: 1
metric.compute(): {'accuracy': 0.905166981726528}
ct, ns, auc: 0.905166981726528, 0, 0
Loaded test data from ../dataset/sst2/test/8.npz
Data length: 1
metric.compute(): {'accuracy': 0.8979289940828402}
ct, ns, auc: 0.8979289940828402, 0, 0
Loaded test data from ../dataset/sst2/test/9.npz
Data length: 1
metric.compute(): {'accuracy': 0.8958031837916064}
ct, ns, auc: 0.8958031837916064, 0, 0
ids: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
stats[1]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
stats[2]: [0.9137323943661971, 0.9029559397657557, 0.9021244309559939, 0.8905693950177936, 0.8767471410419314, 0.9136302294197031, 0.902676399026764, 0.905166981726528, 0.8979289940828402, 0.8958031837916064]
stats[3]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Averaged Test Accuracy: 0.9001
Averaged Test AUC: 0.0000
Std Test Accuracy: 0.0109
Std Test AUC: 0.0000
Loaded train data from ../dataset/sst2/train/9.npz
Data length: 1
Time elapsed 0.02 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/7.npz
Data length: 1
Time elapsed 0.11 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/5.npz
Data length: 1
Time elapsed 0.05 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/6.npz
Data length: 1
Time elapsed 0.03 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/8.npz
Data length: 1
Time elapsed 0.16 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/2.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/1.npz
Data length: 1
Time elapsed 0.06 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/3.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/4.npz
Data length: 1
Time elapsed 0.03 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/0.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.88 GB
------------------------- time cost ------------------------- 64.38049650192261

-------------Round number: 6-------------

Evaluate global model
Loaded test data from ../dataset/sst2/test/0.npz
Data length: 1
metric.compute(): {'accuracy': 0.9181338028169014}
ct, ns, auc: 0.9181338028169014, 0, 0
Loaded test data from ../dataset/sst2/test/1.npz
Data length: 1
metric.compute(): {'accuracy': 0.9051868377021751}
ct, ns, auc: 0.9051868377021751, 0, 0
Loaded test data from ../dataset/sst2/test/2.npz
Data length: 1
metric.compute(): {'accuracy': 0.9021244309559939}
ct, ns, auc: 0.9021244309559939, 0, 0
Loaded test data from ../dataset/sst2/test/3.npz
Data length: 1
metric.compute(): {'accuracy': 0.8932384341637011}
ct, ns, auc: 0.8932384341637011, 0, 0
Loaded test data from ../dataset/sst2/test/4.npz
Data length: 1
metric.compute(): {'accuracy': 0.9047013977128335}
ct, ns, auc: 0.9047013977128335, 0, 0
Loaded test data from ../dataset/sst2/test/5.npz
Data length: 1
metric.compute(): {'accuracy': 0.9224021592442645}
ct, ns, auc: 0.9224021592442645, 0, 0
Loaded test data from ../dataset/sst2/test/6.npz
Data length: 1
metric.compute(): {'accuracy': 0.9087591240875912}
ct, ns, auc: 0.9087591240875912, 0, 0
Loaded test data from ../dataset/sst2/test/7.npz
Data length: 1
metric.compute(): {'accuracy': 0.9067422810333964}
ct, ns, auc: 0.9067422810333964, 0, 0
Loaded test data from ../dataset/sst2/test/8.npz
Data length: 1
metric.compute(): {'accuracy': 0.9040574809805579}
ct, ns, auc: 0.9040574809805579, 0, 0
Loaded test data from ../dataset/sst2/test/9.npz
Data length: 1
metric.compute(): {'accuracy': 0.9088277858176556}
ct, ns, auc: 0.9088277858176556, 0, 0
ids: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
stats[1]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
stats[2]: [0.9181338028169014, 0.9051868377021751, 0.9021244309559939, 0.8932384341637011, 0.9047013977128335, 0.9224021592442645, 0.9087591240875912, 0.9067422810333964, 0.9040574809805579, 0.9088277858176556]
stats[3]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Averaged Test Accuracy: 0.9074
Averaged Test AUC: 0.0000
Std Test Accuracy: 0.0081
Std Test AUC: 0.0000
Loaded train data from ../dataset/sst2/train/1.npz
Data length: 1
Time elapsed 0.06 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/5.npz
Data length: 1
Time elapsed 0.05 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/3.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/2.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/4.npz
Data length: 1
Time elapsed 0.03 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/6.npz
Data length: 1
Time elapsed 0.03 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/8.npz
Data length: 1
Time elapsed 0.16 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/0.npz
Data length: 1
Time elapsed 0.04 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/7.npz
Data length: 1
Time elapsed 0.11 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/9.npz
Data length: 1
Time elapsed 0.02 min
Memory used: 7.88 GB
------------------------- time cost ------------------------- 64.29320096969604

-------------Round number: 7-------------

Evaluate global model
Loaded test data from ../dataset/sst2/test/0.npz
Data length: 1
metric.compute(): {'accuracy': 0.9269366197183099}
ct, ns, auc: 0.9269366197183099, 0, 0
Loaded test data from ../dataset/sst2/test/1.npz
Data length: 1
metric.compute(): {'accuracy': 0.9074177356385945}
ct, ns, auc: 0.9074177356385945, 0, 0
Loaded test data from ../dataset/sst2/test/2.npz
Data length: 1
metric.compute(): {'accuracy': 0.9066767830045523}
ct, ns, auc: 0.9066767830045523, 0, 0
Loaded test data from ../dataset/sst2/test/3.npz
Data length: 1
metric.compute(): {'accuracy': 0.896797153024911}
ct, ns, auc: 0.896797153024911, 0, 0
Loaded test data from ../dataset/sst2/test/4.npz
Data length: 1
metric.compute(): {'accuracy': 0.9047013977128335}
ct, ns, auc: 0.9047013977128335, 0, 0
Loaded test data from ../dataset/sst2/test/5.npz
Data length: 1
metric.compute(): {'accuracy': 0.9230769230769231}
ct, ns, auc: 0.9230769230769231, 0, 0
Loaded test data from ../dataset/sst2/test/6.npz
Data length: 1
metric.compute(): {'accuracy': 0.9148418491484185}
ct, ns, auc: 0.9148418491484185, 0, 0
Loaded test data from ../dataset/sst2/test/7.npz
Data length: 1
metric.compute(): {'accuracy': 0.9136735979836169}
ct, ns, auc: 0.9136735979836169, 0, 0
Loaded test data from ../dataset/sst2/test/8.npz
Data length: 1
metric.compute(): {'accuracy': 0.9053254437869822}
ct, ns, auc: 0.9053254437869822, 0, 0
Loaded test data from ../dataset/sst2/test/9.npz
Data length: 1
metric.compute(): {'accuracy': 0.9088277858176556}
ct, ns, auc: 0.9088277858176556, 0, 0
ids: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
stats[1]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
stats[2]: [0.9269366197183099, 0.9074177356385945, 0.9066767830045523, 0.896797153024911, 0.9047013977128335, 0.9230769230769231, 0.9148418491484185, 0.9136735979836169, 0.9053254437869822, 0.9088277858176556]
stats[3]: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Averaged Test Accuracy: 0.9108
Averaged Test AUC: 0.0000
Std Test Accuracy: 0.0090
Std Test AUC: 0.0000
Loaded train data from ../dataset/sst2/train/9.npz
Data length: 1
Time elapsed 0.02 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/1.npz
Data length: 1
Time elapsed 0.06 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/8.npz
Data length: 1
Time elapsed 0.16 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/7.npz
Data length: 1
Time elapsed 0.11 min
Memory used: 7.88 GB
Loaded train data from ../dataset/sst2/train/3.npz
Data length: 1
